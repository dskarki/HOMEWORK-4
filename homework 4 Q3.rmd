---
output:
  html_document: default
  pdf_document: default
---
---
title: "HW 4 Q3"
author: "Karki"
date: "4/28/2021"
output: pdf_document
--

```{r,include=FALSE}
load("C:/Users/Deepsagar/Downloads/geeklasamp.RData")
library(knitr)
library(raster)
```
```{r,include=FALSE}
data_geek=geeklaesamp
library(ggpubr)
```
** BOXPLOT OF EACH NEIGHBORHOOD**
```{r, include=TRUE}
ggsummarystats(
  data_geek, x = "StatNbhd", y = "Squarefootage", 
  ggfunc = ggboxplot, add = "jitter",
  color = "StatNbhd", palette = "jpg")
```



No, the plot does not seem to support ICC value computed in part a. The ICC computed in part a is 0.929014885. Based on our plot, we can see that the data points are scattered within a cluster.The clusters also have outliers. In all of the individual neighborhoods, we can see that the variation exists. By the ICC computed in part a, the data points in each neighborhood should have been very close, but this
 is not the case as revealed by the boxplot
 
 ** CALCULATING AVERAGE HOME VALUES AND AVERAGE SQUARE FOOTAGE**
 ```{r,include=FALSE}
library(survey)
data_geek$fpc1=7
clustdes= svydesign(id=~StatNbhd, data=data_geek,fpc=~fpc1)
```
```{r,include=TRUE}
summary(clustdes)
avgsqft=svymean(~Squarefootage,design=clustdes)
avgsqft
avghomeval=svymean(~HouseValue,design=clustdes)
avghomeval
```
**NOTING DOWN THE ICC COMPUTED FROM PART A FOR AVERAGE SQFT AND AVERAGE HOMEVALUE**
```{r, include=TRUE}
ICC_household_price=0.937833983
ICC_household_avgsqft=0.929014885
```
** CALCULATING THE DESIGN EFFECTS FOR BOTH AVGHOMEVALUE AND AVGSQFT**
```{r,include=TRUE}
Design_eff_avghomeval= 1+ICC_household_price *4
Design_eff_avghomeval
Design_eff_avgsqft=1+ICC_household_avgsqft*4
Design_eff_avgsqft
```
**ESTIMATING PRICE PER SQUAREFOOT**
```{r,include=FALSE}
theratio=svyratio(~HouseValue,~Squarefootage,clustdes)
```{r,include=TRUE}
theratio
```
** COMPUTING CONFIDENCE INTERVAL OF PRICE PER SQFT WITH THE STANDARD ERROR**
```{r, include=FALSE}
CI_ratio=confint(theratio,level=0.95,df=degf(clustdes))
```
```{r, include=TRUE}
CI_ratio
```
```